{"version":3,"sources":["webpack:///./src/audio.js","webpack:///./src/index.js","webpack:///./src/player.js","webpack:///./src/render.js","webpack:///webpack/bootstrap","webpack:///webpack/startup"],"names":[],"mappings":";;;;;;;AAAa;AACb;AACA,2BAA2B,+DAA+D,gBAAgB,EAAE,EAAE;AAC9G;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,qFAAqF;AACpH;AACA,KAAK;AACL;AACA,8CAA6C,CAAC,cAAc,EAAC;AAC7D,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,iC;;;;;;;ACxDa;AACb;AACA,2BAA2B,+DAA+D,gBAAgB,EAAE,EAAE;AAC9G;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,qFAAqF;AACpH;AACA,KAAK;AACL;AACA,8CAA6C,CAAC,cAAc,EAAC;AAC7D,gBAAgB,mBAAO,CAAC,GAAS;AACjC,iBAAiB,mBAAO,CAAC,EAAU;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,iC;;;;;;;AC1Ca;AACb,8CAA6C,CAAC,cAAc,EAAC;AAC7D,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,kC;;;;;;;AC1Ca;AACb,8CAA6C,CAAC,cAAc,EAAC;AAC7D,cAAc;AACd,iBAAiB,mBAAO,CAAC,GAAU;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,eAAe,EAAE;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,kC;;;;;;UChGA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;UCrBA;UACA;UACA;UACA","file":"main.js","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Audio = void 0;\nclass Audio {\n    constructor(context) {\n        this.audioCtx = context;\n        this.oscillator = this.audioCtx.createOscillator();\n        this.oscillator.type = 'square';\n        this.gain = this.audioCtx.createGain();\n        this.gain.gain.setValueAtTime(0, this.audioCtx.currentTime);\n        this.oscillator.connect(this.gain);\n        this.oscillator.start();\n        this.gain.connect(this.audioCtx.destination);\n        this.setNote(60);\n    }\n    static make() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const ctx = yield Audio.getAudioContext();\n            return new Promise((resolve, reject) => {\n                resolve(new Audio(ctx));\n            });\n        });\n    }\n    static getAudioContext() {\n        return new Promise((resolve, reject) => {\n            const context = new window.AudioContext();\n            if (context.state === 'running') {\n                resolve(context);\n            }\n            else {\n                setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                    resolve(yield Audio.getAudioContext());\n                }), 500);\n            }\n        });\n    }\n    setNote(note) {\n        this.oscillator.frequency.setValueAtTime(440 * Math.pow(2, (note - 69) / 12), this.audioCtx.currentTime);\n    }\n    noteOn() {\n        this.gain.gain.setValueAtTime(0.2, this.audioCtx.currentTime);\n    }\n    noteOff() {\n        this.gain.gain.setValueAtTime(0.0, this.audioCtx.currentTime);\n    }\n}\nexports.Audio = Audio;\n//# sourceMappingURL=audio.js.map","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst audio_1 = require(\"./audio\");\nconst render_1 = require(\"./render\");\nconst body = document.getElementsByTagName('body')[0];\nfunction go() {\n    return __awaiter(this, void 0, void 0, function* () {\n        const keySet = new Set();\n        const a = yield audio_1.Audio.make();\n        const r = new render_1.Render(body, keySet, a);\n        body.addEventListener('keydown', handleKey);\n        body.addEventListener('keyup', handleKey);\n        function handleKey(ev) {\n            if (ev.type === 'keydown') {\n                keySet.add(ev.key);\n                switch (ev.key) {\n                    case 'Shift':\n                        r.noteOn();\n                        a.noteOn();\n                        break;\n                }\n            }\n            else if (ev.type === 'keyup') {\n                keySet.delete(ev.key);\n                if (ev.key === 'Shift') {\n                    r.noteOff();\n                    a.noteOff();\n                }\n            }\n        }\n    });\n}\ngo();\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Player = void 0;\nclass Player {\n    constructor(x, y) {\n        this.platforms = [];\n        this.x = x;\n        this.y = y;\n        this.yv = 0;\n    }\n    setPlatforms(platforms) {\n        this.platforms.splice(0, this.platforms.length, ...platforms);\n    }\n    getPlatformIndex(y) {\n        let index = -1;\n        while (index < this.platforms.length && this.platforms[index + 1] <= y) {\n            index = index + 1;\n        }\n        return index;\n    }\n    advance() {\n        const previousPlatformIndex = this.getPlatformIndex(this.y);\n        this.y += this.yv;\n        const newPlatformIndex = this.getPlatformIndex(this.y);\n        if (previousPlatformIndex > newPlatformIndex) {\n            this.y = this.platforms[previousPlatformIndex];\n            this.yv = 0;\n        }\n        else {\n            this.yv -= 0.015;\n        }\n    }\n    down() {\n        if (this.yv === 0) {\n            this.y -= 0.01;\n        }\n    }\n    up() {\n        this.yv = 0.1;\n    }\n}\nexports.Player = Player;\n//# sourceMappingURL=player.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Render = void 0;\nconst player_1 = require(\"./player\");\nclass Render {\n    constructor(container, keySet, a) {\n        this.basicWidth = [\n            0.05,\n            0.01,\n            0.05,\n            0.01,\n            0.05,\n            0.05,\n            0.01,\n            0.05,\n            0.01,\n            0.05,\n            0.01,\n            0.05 // B\n        ];\n        this.basicColor = [\n            'black',\n            'transparent',\n            'lightblue',\n            'transparent',\n            'lightblue',\n            'blue',\n            'transparent',\n            'blue',\n            'transparent',\n            'lightblue',\n            'transparent',\n            'lightblue' // B\n        ];\n        this.keySet = keySet;\n        this.audio = a;\n        this.canvas = document.createElement('canvas');\n        this.canvas.width = 1500;\n        this.canvas.height = 900;\n        container.appendChild(this.canvas);\n        this.ctx = this.canvas.getContext('2d');\n        this.player = new player_1.Player(0, 12);\n        this.player.setPlatforms([0, 2, 4, 5, 7, 9, 11, 12, 14, 16, 17, 19, 21, 23, 24]);\n        this.noteIsOn = false;\n        this.render();\n    }\n    noteOn() {\n        this.noteIsOn = true;\n    }\n    noteOff() {\n        this.noteIsOn = false;\n    }\n    render() {\n        this.ctx.resetTransform();\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        // 16 + 1 beats horizontally\n        // 24 semitones vertically; also positive = up\n        this.ctx.scale(this.canvas.width / 33, -this.canvas.height / 26);\n        this.ctx.translate(1, -25);\n        this.ctx.strokeStyle = 'red';\n        this.ctx.lineWidth = 0.6;\n        this.ctx.beginPath();\n        if (this.noteIsOn) {\n            this.ctx.arc(this.player.x, this.player.y + 0.5, 0.2, 1, 2 * Math.PI - 1);\n        }\n        else {\n            this.ctx.arc(this.player.x, this.player.y + 0.5, 0.2, -Math.PI, Math.PI);\n        }\n        this.ctx.stroke();\n        for (let n = 0; n <= 24; ++n) {\n            this.ctx.lineWidth = this.getWidth(n);\n            this.ctx.strokeStyle = this.getColor(n);\n            this.ctx.beginPath();\n            this.ctx.moveTo(-1, n);\n            this.ctx.lineTo(16, n);\n            this.ctx.stroke();\n        }\n        requestAnimationFrame(() => { this.render(); });\n        if (this.keySet.has('ArrowUp')) {\n            this.player.up();\n        }\n        else if (this.keySet.has('ArrowDown')) {\n            this.player.down();\n        }\n        ;\n        this.player.advance();\n        this.audio.setNote(this.player.y + 60);\n    }\n    getWidth(n) {\n        return this.basicWidth[n % 12];\n    }\n    getColor(n) {\n        return this.basicColor[n % 12];\n    }\n}\nexports.Render = Render;\n//# sourceMappingURL=render.js.map","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module\n// This entry module is referenced by other modules so it can't be inlined\n__webpack_require__(138);\n"],"sourceRoot":""}